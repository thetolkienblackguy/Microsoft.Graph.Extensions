# Get-GraphAccessToken.md

`Get-GraphAccessToken` is a PowerShell function that obtains an access token for the Microsoft Graph API using client credentials flow.

## Synopsis

This function gets an access token for the Microsoft Graph API.

## Syntax

```powershell
Get-GraphAccessToken
  -ClientId <string>
  -ClientSecret <object>
  -TenantId <string>
  [-AsPlainText]
```

## Description

The `Get-GraphAccessToken` function provides a streamlined way to obtain an access token for the Microsoft Graph API using the client credentials flow. This is particularly useful for service-to-service scenarios where user interaction is not possible or required.

## Parameters

- `-ClientId <string>`
  Specifies the client ID of the application registered in Azure AD.

- `-ClientSecret <object>`
  Specifies the client secret of the application. This parameter uses the SecureStringDecoder attribute, allowing it to accept either a SecureString or a plain text string. Alias: Secret.

- `-TenantId <string>`
  Specifies the tenant ID of the Azure AD directory.

- `-AsPlainText <switch>`
  If specified, returns the access token as a plain text string instead of a SecureString.

## Examples

### Example 1: Get an access token as a SecureString
```powershell
Get-GraphAccessToken -ClientId "00000000-0000-0000-0000-000000000000" -ClientSecret "YourClientSecret" -TenantId "00000000-0000-0000-0000-000000000000"
```

### Example 2: Get an access token as plain text
```powershell
Get-GraphAccessToken -ClientId "00000000-0000-0000-0000-000000000000" -ClientSecret "YourClientSecret" -TenantId "00000000-0000-0000-0000-000000000000" -AsPlainText
```

### Example 3: Using a SecureString for the client secret
```powershell
$secureSecret = ConvertTo-SecureString "YourClientSecret" -AsPlainText -Force
Get-GraphAccessToken -ClientId "00000000-0000-0000-0000-000000000000" -ClientSecret $secureSecret -TenantId "00000000-0000-0000-0000-000000000000"
```

## Security Note

It's recommended to use a SecureString for the client secret whenever possible to enhance security. The function accepts both plain text and SecureString for flexibility, but storing and passing secrets as SecureString is generally more secure.

---

*Disclaimer: This README was generated by Claude AI 3.5 Sonnet.*
